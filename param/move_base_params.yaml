# # #FileName: move_base_params.yaml
# # #Copyright: 2016-2018 ROS小课堂www.corvin.cn
# # #Author: corvin
# # #Description:
# # # move_base软件包的通用配置参数,现在依次解释每个参数意义:
# # #   shutdown_costmaps:当move_base在不活动状态时,是否关掉costmap.
# # #   controller_frequency:向底盘控制移动话题cmd_vel发送命令的频率.
# # #   controller_patience:在空间清理操作执行前,控制器花多长时间等有效控制下发.
# # #   planner_frequency:全局规划操作的执行频率.如果设置为0.0,则全局规划器仅
# # #       在接收到新的目标点或者局部规划器报告路径堵塞时才会重新执行规划操作.
# # #   planner_patience:在空间清理操作执行前,留给规划器多长时间来找出一条有效规划.
# # #   oscillation_timeout:执行修复机制前,允许振荡的时长.
# # #   oscillation_distance:来回运动在多大距离以上不会被认为是振荡.
# # #   base_local_planner:指定用于move_base的局部规划器插件名称.
# # #   base_global_planner:指定用于move_base的全局规划器插件名称.

# # shutdown_costmaps: true

# # controller_frequency: 3.0
# # controller_patience: 3.0

# # planner_frequency: 1.0
# # planner_patience: 5.0 

# # oscillation_timeout: 8.0
# # oscillation_distance: 0.3

# # base_local_planner: "dwa_local_planner/DWAPlannerROS"
# # base_global_planner: "global_planner/GlobalPlanner"


#   ######################################################################################
# #以上为原参数
# #以下为调试优化参数


# shutdown_costmaps: true

# controller_frequency: 8.0
# # controller_frequency: 5.0
# # controller_patience: 3.0
# # controller_frequency: 5.0
# controller_patience: 3.0

# planner_frequency: 1.0
# planner_patience: 5.0 

# # oscillation_timeout: 8.0
# # oscillation_distance: 0.3
# oscillation_timeout: 8.0
# oscillation_distance: 0.2

# #base_local_planner: "teb_local_planner/TebLocalPlannerROS"
# base_local_planner: "dwa_local_planner/DWAPlannerROS"
# base_global_planner: "global_planner/GlobalPlanner"

# conservative_reset_dist: 0.0     # 关闭“到达目标后清 3m 以外障碍物”这个巨坑功能
# clearing_radius: 0.0             # 部分 move_base fork 用的同名参数



#FileName: move_base_params.yaml
#Copyright: 2016-2018 ROS小课堂www.corvin.cn
#Author: corvin
#Description:
# move_base软件包的通用配置参数,现在依次解释每个参数意义:
#   shutdown_costmaps:当move_base在不活动状态时,是否关掉costmap.
#   controller_frequency:向底盘控制移动话题cmd_vel发送命令的频率.
#   controller_patience:在空间清理操作执行前,控制器花多长时间等有效控制下发.
#   planner_frequency:全局规划操作的执行频率.如果设置为0.0,则全局规划器仅
#       在接收到新的目标点或者局部规划器报告路径堵塞时才会重新执行规划操作.
#   planner_patience:在空间清理操作执行前,留给规划器多长时间来找出一条有效规划.
#   oscillation_timeout:执行修复机制前,允许振荡的时长.
#   oscillation_distance:来回运动在多大距离以上不会被认为是振荡.
#   base_local_planner:指定用于move_base的局部规划器插件名称.
#   base_global_planner:指定用于move_base的全局规划器插件名称.

# shutdown_costmaps: true
# controller_frequency: 5.0
# controller_patience: 3.0
# planner_frequency: 5.0
# planner_patience: 5.0
# oscillation_timeout: 8.0
# oscillation_distance: 0.3
# # base_local_planner: "teb_local_planner/TebLocalPlannerROS"
# base_local_planner: "dwa_local_planner/DWAPlannerROS"
# base_global_planner: "global_planner/GlobalPlanner"

# # === 下面这两行是所有量产项目的必备补丁 ===
# conservative_reset_dist: 0.0     # 关闭“到达目标后清 3m 以外障碍物”这个巨坑功能
# clearing_radius: 0.0             # 部分 move_base fork 用的同名参数



# =====================================================================
# =========== Optimized move_base Configuration v4.1 ============
# Goal: Robust recovery, logical behavior, less sensitive to obstacles.
# =====================================================================

# [优化] 提高控制器频率以获得更快的响应
controller_frequency: 15
controller_patience: 5.0

# 全局规划频率不需要太高
planner_frequency: 2.0
planner_patience: 10.0

# [优化] 延长振荡超时，给DWA更多时间解决问题，避免过早放弃
oscillation_timeout: 15.0
oscillation_distance: 0.3

base_local_planner: "dwa_local_planner/DWAPlannerROS"
base_global_planner: "global_planner/GlobalPlanner"

# ==================== Recovery Behaviors (Corrected & Optimized) ====================
recovery_behavior_enabled: true
# [优化] clearing_rotation_allowed 建议设为 false，因为我们自定义了旋转行为。
# 开启它会在我们的行为链执行前，额外增加一次360度的旋转，通常是不必要的。
clearing_rotation_allowed: false

recovery_behaviors:
  # 优先级 1: 清除局部代价地图。这是最快、成本最低的尝试。
  - name: 'conservative_reset'
    type: 'clear_costmap_recovery/ClearCostmapRecovery'
  # 优先级 3: 再次清除局部代价地图。
  # 在旋转之后，机器人可能看到了新的空间，但旧的障碍物信息可能还残留在地图上，所以再次清除。
  - name: 'aggressive_reset'
    type: 'clear_costmap_recovery/ClearCostmapRecovery'